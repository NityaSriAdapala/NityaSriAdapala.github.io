<!DOCTYPE html>
<html>
<head>
    <title>Project 2</title>
    <style>
        h1 {
            font-family: Georgia, sans-serif;
            margin: 20px;
            text-align: center;
        }
        h2 {
            font-family: Georgia, sans-serif;
            margin: 20px;
            text-align: center;
        }
        h4 {
            font-family: Georgia, sans-serif;
            margin: 20px;
            text-align: center;
        }
        p {
            font-family: Georgia, sans-serif;
            margin: 20px;
            padding: 10px;
        }
        .image-container {
            display: flex; /* Use flexbox to align items */
            flex-wrap: wrap; /* Allow wrapping */
            gap: 10px; /* Optional: Add space between images */
        }
        
        .image-container div {
            flex: 1 1 auto; /* Allow items to grow/shrink */
            max-width: 200px; /* Optional: Set a max width */
        }
        
        .image-container img {
            height: 150px; /* Set a uniform height for all images */
            object-fit: cover; /* Ensure images maintain aspect ratio and fill the space */
            width: 100%; /* Make images responsive */
        }

        .image-caption {
            text-align: center; /* Center the caption text */
            margin-top: 5px; /* Add some space above the caption */
        }
        
        .image-container-2 img {
            height: 600px; 
            object-fit: cover; 
            width: 80%; 
        }    
        
        .scaled-image {
            width: 80%; 
            height: auto;  
        }
        
    </style>
</head>
<body>
    <h1> Project 2: Fun with Filters and Frequencies! </h1>

    <h2> NITYA SRI ADAPALA </h2>
    
    <h2> Introduction </h2>

    <p> This project focusses on first building the intuition needed for 2D convolutions and filtering before using frequencies to sharpen images,
        combine two images into one, blend two images using multiresolution blending. </p>

    <h2> Finite Difference Operator </h2>

    <p> First, I showed the partial derivative in x and y of the cameraman image by convolving the image with finite difference operators D_x and D_y.
        To accomplish this, I used convolve2d from the scipy.signal library. Then, I computed and showed the gradient magnitude image. To turn this 
        into an edge image, I binarized the gradient magnitude image by choosing the appropriate threshold, which took a couple tries to get right. </p>

    <div class="image-container">
        <div>
            <img src="media/01_cameraman.png" alt="cameraman original image">
            <div class="image-caption">Cameraman Original Image</div>
        </div>
        <div>
            <img src="media/02_grad_mag_img.png" alt="gradient magnitude image of cameraman">
            <div class="image-caption">Gradient Magnitude Image of Cameraman</div>
        </div>
        <div>
            <img src="media/03_binarized_grad_mag_img.png" alt="binarized gradient magnitude image of cameraman">
            <div class="image-caption">Binarized Gradient Magnitude Image of Cameraman</div>
        </div>
    </div>
    
    <h2> Derivative of Gaussian (DoG) Filter </h2>

    <p> I noticed that the results with just the finite difference operators D_x and D_y were quite noisy so I used a smoothing operator called the
        Gaussian filter. I created the gaussian filter by first creating a 1D Gaussian Kernel using cv2.getGaussianKernel(ksize, sigma) and then I took the outer 
        product with its transpose to get a 2D gaussian kernel. We can create a blurred version of the original image by convolving with this gaussian kernel
        and repeat the procedure in the previous part. </p>

    <div class="image-container">
        <div>
            <img src="media/04_blurred_cameraman.png" alt="cameraman blurred image">
            <div class="image-caption">Cameraman Blurred Image</div>
        </div>
        <div>
            <img src="media/05_blurred_grad_mag_img.png" alt="gradient magnitude image of blurred cameraman">
            <div class="image-caption">Gradient Magnitude Image of Blurred Cameraman</div>
        </div>
        <div>
            <img src="media/06_blurred_binarized_grad_mag_img.png" alt="binarized gradient magnitude image of blurred cameraman">
            <div class="image-caption">Binarized Gradient Magnitude Image of Blurred Cameraman</div>
        </div>
    </div>
        
    <p> I see the following differences: </p>

    <p> I now do the same thing with a single convolution instead of two by creating a derivative of gaussian filters. First, I convolve the gaussian with D_x 
        and D_y. Then, I display the resulting DoG filters as images. I verify that I get the same result as before.</p>

    <div class="image-container">
        <div>
            <img src="media/04_blurred_cameraman.png" alt="cameraman blurred image">
            <div class="image-caption">Cameraman Blurred Image</div>
        </div>
        <div>
            <img src="media/07_blurred_grad_mag_img_single_convolution.png" alt="gradient magnitude image of blurred cameraman in a single convolution">
            <div class="image-caption">Gradient Magnitude Image of Blurred Cameraman in a Single Convolution</div>
        </div>
        <div>
            <img src="media/08_blurred_binarized_grad_mag_img_single_convolution.png" alt="binarized gradient magnitude image of blurred cameraman in a single convolution">
            <div class="image-caption">Binarized Gradient Magnitude Image of Blurred Cameraman in a Single Convolution</div>
        </div>
    </div>

    <h2> Image "Sharpening" </h2>

    <p> In this part, we will derive the unsharp masking technique. The Gaussian filter is a low pass filter that retains only the low frequencies. Therefore, if 
        we subtract the blurred version from the original image, we can get the high frequenciea of the image which can make the image look sharper. We combine
        this all into a single convolution operation which is called the unsharp mask filter. </p>

    <div class="image-container">
        <div>
            <img src="media/09_taj_mahal.jpg" alt="Taj Mahal">
            <div class="image-caption">Taj Mahal Original Image</div>
        </div>
        <div>
            <img src="media/10_blurred_taj_mahal.png" alt="Blurred Taj Mahal">
            <div class="image-caption">Blurred Taj Mahal</div>
        </div>
        <div>
            <img src="media/11_high_freq_taj_mahal.png" alt="High Frequencies of Taj Mahal Image">
            <div class="image-caption">High Frequency Image of Taj Mahal</div>
        </div>
    </div>

    <div class="image-container">
        <div>
            <img src="media/12_taj_sharpened_1.png" alt="Sharpened Taj Mahal with Alpha = 1.0">
            <div class="image-caption">Sharpened Taj Mahal with Alpha = 1.0</div>
        </div>
        <div>
            <img src="media/13_taj_sharpened_2.png" alt="Sharpened Taj Mahal with Alpha = 2.0">
            <div class="image-caption">Sharpened Taj Mahal with Alpha = 2.0</div>
        </div>
        <div>
            <img src="media/14_taj_sharpened_4.png" alt="Sharpened Taj Mahal with Alpha = 4.0">
            <div class="image-caption">Sharpened Taj Mahal with Alpha = 4.0</div>
        </div>
    </div>

    <p> Here is a sharp image that I blurred and then sharpened again: </p>

    <div class="image-container">
        <div>
            <img src="media/15_campanile.png" alt="Campanile">
            <div class="image-caption">Campanile Original Image</div>
        </div>
        <div>
            <img src="media/16_campanile_sharpened_1.png" alt="Sharpened Campanile with Alpha = 1.0">
            <div class="image-caption">Sharpened Campanile with Alpha = 1.0</div>
        </div>
    </div>
    
    <div class="image-container">
        <div>
            <img src="media/17_campanile_sharpened_2.png" alt="Sharpened Campanile with Alpha = 2.0">
            <div class="image-caption">Sharpened Campanile with Alpha = 2.0</div>
        </div>
        <div>
            <img src="media/18_campanile_sharpened_4.png" alt="Sharpened Campanile with Alpha = 4.0">
            <div class="image-caption">Sharpened Campanile with Alpha = 4.0</div>
        </div>
    </div>

    <h2> Hybrid Images </h2>

    <p> The goal of this part of the assignment is to create hybrid images using the approach described in the SIGGRAPH 2006 paper by Oliva, Torralba, and Schyns.
        Hybrid images are static images that change in interpretation as a function of the viewing distance. The basic idea is that high frequency tends to dominate 
        perception when it is available, but, at a distance, only the low frequency (smooth) part of the signal can be seen. By blending the high frequency portion 
        of one image with the low-frequency portion of another, you get a hybrid image that leads to different interpretations at different distances.</p>

    <p> Here are the sample images I used for debugging and the hybrid image produced from them: </p> 

    <div class="image-container">
        <div>
            <img src="media/19_DerekPicture.jpg" alt="Picture of Derek">
            <div class="image-caption">Image of human Derek</div>
        </div>
        <div>
            <img src="media/20_nutmeg.jpg" alt="Nutmeg the cat">
            <div class="image-caption">Image of cat Nutmeg</div>
        </div>
        <div>
            <img src="media/21_hybrid_derek_nutmeg.png" alt="Hybrid image of Derek and Nutmeg">
            <div class="image-caption">Hybrid image of Derek and Nutmeg</div>
        </div>
    </div>

    <p> In order to create this hybrid image, I wrote code to low-pass filter one image by using a Gaussian filter, high-pass filter the second image by subtracting 
        the blurred image from the original image, and then averaged the two images to produce the final hybrid image. For a low-pass filter, Oliva et al. suggested
        using a standard 2D Gaussian filter. For a high-pass filter, they suggest using the impulse filter minus the Gaussian filter (which can be computed by 
        subtracting the Gaussian-filtered image from the original). I chose the cutoff-frequency of each filter by doing some experimentation. </p>
        
    <p> My favorite result is the hybrid image of Nadal and Federer so I also illustrated the process through frequency analysis. I showed the log magnitude of the 
        Fourier transform of the two input images, the filtered images, and the hybrid image using: plt.imshow(np.log(np.abs(np.fft.fftshift(np.fft.fft2(gray_image)))))</p>

    <div class="image-container">
        <div>
            <img src="media/25_federer.jpg" alt="Picture of Federer">
            <div class="image-caption">Image of Roger Federer</div>
        </div>
        <div>
            <img src="media/26_nadal.jpg" alt="Picture of Nadal">
            <div class="image-caption">Image of Rafael Nadal</div>
        </div>
        <div>
            <img src="media/27_hybrid_federer_nadal.png" alt="Hybrid image of Federer and Nadal">
            <div class="image-caption">Hybrid image of Federer and Nadal</div>
        </div>
    </div>

    <div class="image-container">
        <div>
            <img src="media/28_federer_before.png" alt="Frequency analysis of Federer original image">
            <div class="image-caption">Frequency Analaysis of Original Federer Image</div>
        </div>
        <div>
            <img src="media/29_nadal_before.png" alt="Frequency analysis of Nadal original image">
            <div class="image-caption">Frequency Analaysis of Original Nadal Image</div>
        </div>
        <div>
            <img src="media/30_filtered_federer.png" alt="Frequency analysis of Federer filtered image">
            <div class="image-caption">Frequency Analaysis of Filtered Federer Image</div>
        </div>
        <div>
            <img src="media/31_filered_nadal.png" alt="Frequency analysis of Nadal filtered image">
            <div class="image-caption">Frequency Analaysis of Filtered Nadal Image</div>
        </div>
        <div>
            <img src="media/32_hybrid.png" alt="Frequency analysis of Hybrid image of Federer and Nadal">
            <div class="image-caption">Frequency analysis of hybrid image of Federer and Nadal</div>
        </div>
    </div>
    
    <p> This is an example of a failure case because it is quite difficult to see the tiger: </p>
    
    <div class="image-container">
        <div>
            <img src="media/22_koala.jpg" alt="Picture of Koala">
            <div class="image-caption">Image of Koala</div>
        </div>
        <div>
            <img src="media/23_tiger.jpg" alt="Picture of tiger">
            <div class="image-caption">Image of Tiger</div>
        </div>
        <div>
            <img src="media/24_hybrid_koala_tiger.png" alt="Hybrid image of Koala and Tiger">
            <div class="image-caption">Hybrid image of Koala and Tiger</div>
        </div>
    </div>
    
    <h2> Gaussian and Laplacian Stacks </h2>

    <p> The goal of this part of the assignment is to blend two images seamlessly using multi resolution blending as described in the 1983 paper by Burt and Adelson. 
        An image spline is a smooth seam joining two image together by gently distorting them. Multiresolution blending computes a gentle seam between the two images 
        seperately at each band of image frequencies, resulting in a much smoother seam. First, I create and visualize the Gaussian and Laplacian stacks and using the 
        stacks, I blend together images. Therefore, for this part I implemented the Gaussian and Laplacian stacks, which are similar to pyramids but without the 
        downsampling. This will prepare me for the next step for Multi-resolution blending. </p>

    <div class="image-container">
        <div>
            <img src="media/33_apple.jpg" alt="Picture of Apple">
            <div class="image-caption">Image of Apple</div>
        </div>
        <div>
            <img src="media/34_orange.jpg" alt="Picture of Orange">
            <div class="image-caption">Image of Orange</div>
        </div>
    </div>

    <div class="image-container-2">
        <div>
            <img src="media/35_gauss_stack_apple.png" alt="Picture of Gaussian Stack of Apple">
            <div class="image-caption">Gaussian Stack of Apple</div>
        </div>
    </div>

    <div class="image-container-2">
        <div>
            <img src="media/36_laplacian_stack_apple.png" alt="Picture of Laplacian Stack of Apple">
            <div class="image-caption">Laplacian Stack of Apple</div>
        </div>
    </div>

    <div class="image-container-2">
        <div>
            <img src="media/37_gauss_stack_orange.png" alt="Picture of Gaussian Stack of Orange">
            <div class="image-caption">Gaussian Stack of Orange</div>
        </div>
    </div>

    <div class="image-container-2">
        <div>
            <img src="media/38_laplacian_stack_orange.png" alt="Picture of Laplacian Stack of Orange">
            <div class="image-caption">Laplacian Stack of Orange</div>
        </div>
    </div>

    <div class="image-container">
        <div>
            <img src="media/39_mask_orapple.jpg" alt="Picture of Mask for Orapple">
            <div class="image-caption">Regular Vertical Seam Mask</div>
        </div>
        <div>
            <img src="media/40_gauss_stack_mask_orapple.png" alt="Gaussian stack of Mask">
            <div class="image-caption">Gaussian Stack of Mask</div>
        </div>
    </div>

    <div class="image-container">
        <div>
            <img src="media/41_laplacian_stack_hybrid_orapple.png" alt="Picture of Laplacian stack of Hybrid Image of Orange and Apple">
            <div class="image-caption">Laplacian Stack of Hybrid Image Orapple</div>
        </div>
        <div>
            <img src="media/42_orapple.png" alt="Orapple hybrid image">
            <div class="image-caption">Orapple</div>
        </div>
    </div>

41_laplacian_stack_hybrid_orapple
    
    <h2> Multiresolution Blending </h2>

    <p> In this part, we will mainly focus on blending two images together. First, I wrote some code to use my Gaussian and Laplacian stacks from the previous part to 
        blend the images together. </p>

    <p> Here are the sample images I used for debugging: </p>

    <p> Here are my own images I used for debugging: </p>
    
</body>
</html>
